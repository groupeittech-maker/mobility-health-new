<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tableau de bord Administrateur H√¥pital - Mobility Health</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/admin.css">
</head>
<body class="protected">
    <nav class="navbar">
        <div class="container">
            <div class="navbar-brand">
                <img src="assets/logo_officiel_mh.jpg" alt="Mobility HealthCare" class="brand-logo">
                <span class="brand-text">Comptabilit√© hospitali√®re</span>
            </div>
            <ul class="nav-menu">
                <li><a href="hospital-dashboard.html" class="active">Portail</a></li>
                <li><a href="hospital-invoices.html">Factures hospitali√®res</a></li>
                <li><a href="#" onclick="logout()">D√©connexion</a></li>
            </ul>
        </div>
    </nav>

    <main class="container">
        <div class="dashboard-header">
            <div>
                <h2 id="dashboardTitle">Vue unifi√©e pour les agents comptables hospitaliers</h2>
                <p class="muted">
                    Suivez vos factures en temps r√©el, rep√©rez les dossiers bloqu√©s et acc√©dez rapidement aux outils cl√©s.
                </p>
                <p id="welcomeMessage">
                    Bienvenue, <span id="userName"></span>
                    <span id="userRoleBadge" class="role-badge"></span>
                </p>
            </div>
            <div class="section-tabs" id="dashboardTabs">
                <a class="tab-btn" href="hospital-invoices.html" id="tabFacturerSejours">Facturer les s√©jours (0)</a>
                <a class="tab-btn active" href="#portalSection" id="tabFacturesEnCours">Factures hospitali√®res (0)</a>
                <a class="tab-btn" href="#processedInvoicesSection" id="tabHistoriqueFactures">Historique des factures (0)</a>
            </div>
        </div>

        <section class="dashboard-section" id="portalSection">
            <div class="section-heading">
                <div>
                    <h3>Suivi des factures et validations</h3>
                    <p class="muted">
                        Visualisez les factures en attente d‚Äôaccords m√©dicaux, sinistre ou comptabilit√© et acc√©dez aux
                        actions cl√©s de votre r√¥le.
                    </p>
                </div>
            </div>

            <div class="dashboard-stats" id="hospitalStats">
                <div class="stat-card">
                    <h3>Factures en cours</h3>
                    <p id="pendingInvoicesCount">0</p>
                    <small class="muted">En attente d‚Äôaccord m√©dical, sinistre ou compta</small>
                </div>

                <div class="stat-card">
                    <h3>Factures trait√©es</h3>
                    <p id="processedInvoicesCount">0</p>
                    <small class="muted">Factures valid√©es ou refus√©es</small>
                </div>
            </div>

            <section class="portal-subsection">
                <div class="table-toolbar">
                    <div>
                        <h3>Factures en cours</h3>
                        <p class="muted">S√©jours factur√©s en attente d‚Äôaccords.</p>
                    </div>
                    <div class="toolbar-actions" style="display: flex; align-items: center; gap: 0.75rem; flex-wrap: wrap;">
                        <label for="searchInvoicesDashboard" class="sr-only">Rechercher</label>
                        <input type="search" id="searchInvoicesDashboard" class="search-input" placeholder="Rechercher facture, patient, sinistre..." aria-label="Rechercher dans les factures" style="max-width: 280px;">
                        <button type="button" class="secondary-button" id="refreshInvoicesBtn">Actualiser</button>
                    </div>
                </div>

                <div id="invoicesError" class="alert alert-error" hidden></div>

                <div id="pendingInvoicesLoading" class="loading" hidden>
                    <div class="spinner"></div>
                </div>

                <div id="pendingInvoicesEmpty" class="empty-state" hidden>
                    <div class="empty-state-icon">üìÑ</div>
                    <p>Aucune facture en cours pour votre √©tablissement.</p>
                    <p class="muted">Les nouvelles factures appara√Ætront automatiquement.</p>
                </div>

                <div class="table-wrapper">
                    <table class="data-table" id="pendingInvoicesTable" hidden>
                        <thead>
                            <tr>
                                <th>Facture</th>
                                <th>Patient</th>
                                <th>Montant TTC</th>
                                <th>Statut</th>
                                <th>Cr√©√©e le</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="pendingInvoicesTableBody"></tbody>
                    </table>
                </div>
                <div id="pendingInvoicesPagination" class="table-pagination-wrapper" hidden></div>
            </section>

            <section class="portal-subsection" id="processedInvoicesSection">
                <div class="table-toolbar">
                    <div>
                        <h3>Factures trait√©es</h3>
                        <p class="muted">Factures valid√©es ou rejet√©es par la comptabilit√©.</p>
                    </div>
                    <div class="toolbar-actions">
                        <label for="searchProcessedInvoices" class="sr-only">Rechercher</label>
                        <input type="search" id="searchProcessedInvoices" class="search-input" placeholder="Rechercher facture, patient, sinistre..." aria-label="Rechercher dans les factures trait√©es" style="max-width: 280px;">
                    </div>
                </div>

                <div id="processedInvoicesLoading" class="loading" hidden>
                    <div class="spinner"></div>
                </div>

                <div id="processedInvoicesEmpty" class="empty-state" hidden>
                    <div class="empty-state-icon">‚úÖ</div>
                    <p>Aucune facture trait√©e pour le moment.</p>
                    <p class="muted">Les factures valid√©es appara√Ætront ici.</p>
                </div>

                <div class="table-wrapper">
                    <table class="data-table" id="processedInvoicesTable" hidden>
                        <thead>
                            <tr>
                                <th>Facture</th>
                                <th>Patient</th>
                                <th>Montant TTC</th>
                                <th>Statut</th>
                                <th>Trait√©e le</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="processedInvoicesTableBody"></tbody>
                    </table>
                </div>
                <div id="processedInvoicesPagination" class="table-pagination-wrapper" hidden></div>
            </section>
        </section>

    </main>

    <footer>
        <div class="container">
            <p>&copy; 2024 Mobility Health. Tous droits r√©serv√©s.</p>
        </div>
    </footer>

    <script src="js/api.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/hospital-dashboard.js"></script>
</body>
</html>



